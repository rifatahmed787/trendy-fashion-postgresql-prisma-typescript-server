
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


// user model

model User {
  id       Int          @id @default(autoincrement())
  username String   
  email    String       @unique
  password String
  avatar String         @default("https://res.cloudinary.com/dztlowlu0/image/upload/v1700031261/avatar_ylo9mt.png")
  role String           @default("user")
  address Address?
  purchasedProducts     Products[]
  reviewProducts        ProductReview[]
  posts                 Post[]
  cartProducts          CartProduct[]
  wishLists             WishList[] 
  @@map("Users")
}

model Address {
  id Int                 @id @default(autoincrement())
  //  id String          @id @default(uuid())
  street_address String
  city String
  postal_code String
  country String
  phone_number String
  district_name String
  address_id Int         @unique
  created_at DateTime    @default(now())
  updated_at DateTime    @updatedAt
  user User              @relation(fields: [address_id], references: [id])
}


// Products model

model Products {
  id                  Int       @id @default(autoincrement())
  productId           String    @unique
  productName         String
  productDetails      String?
  productColor        String[]
  productQuality      String    
  productImage        String[]
  productSize         String[]
  productPrice        Float
  productRating       Float?
  productSpecification String[]
  productCategory     String   
  productGender       String   
  age                 String[]   
  relatedProducts     String[]  
  buyerId Int?
  buyer               User? @relation(fields: [buyerId], references: [id])
  productReviews      ProductReview[]
  wishLists           WishList[]
  cartProducts       CartProduct[]
  createdAt  DateTime @default(now())
}


// product reviews
model ProductReview {
  id           Int      @id @default(autoincrement())
  rating       Int      
  reviewText   String?  
  createdAt  DateTime @default(now()) 
  reviewer     User     @relation( fields: [reviewerId], references: [id]) 
  reviewerId   Int
  productId    Int      @map("product_id")
  review      Products  @relation(fields: [productId], references: [id])
}


// cart model
model CartProduct {
  id                 Int      @id @default(autoincrement())
  userId             Int
  user               User     @relation(fields: [userId], references: [id])
  productId          Int
  product            Products @relation(fields: [productId], references: [id])
  quantity           Int
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}



// order model
model Order {
  id        Int      @id @default(autoincrement())
  userId    Int      // Foreign key to associate the order with a user
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  products  OrderProduct[]
}

model OrderProduct {
  id         Int     @id @default(autoincrement())
  orderId    Int
  productId  Int     // Foreign key to associate the product with the order
  quantity   Int     // The quantity of the product in the order
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  order Order? @relation(fields: [orderId], references: [id])
}


// wish list model

model WishList {
  id      Int    @id @default(autoincrement())
  userId  Int
  user    User   @relation(fields: [userId], references: [id])
  productId Int
  product Products @relation(fields: [productId], references: [id])
}


// faq/accordian model

model ProductAccordian {
  id        Int      @id @default(autoincrement())
  question  String
  answer    String
  category String
}


// blog post model

model Category{
  id Int @id @default(autoincrement())
  name String
  posts Post[]
  @@map("Categories")
}


model Post{
  id Int @id @default(autoincrement())
  title String
  author_id Int
  author User @relation(fields: [author_id], references: [id])
  category_id Int
  category Category @relation(fields: [category_id], references:[id] )
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("Posts")
}


